[2019-05-20:15:34:38:INFO:sockeye.utils:log_sockeye_version] Sockeye version 1.18.98, commit unknown, path /notebooks/sockeye/sockeye/__init__.py
[2019-05-20:15:34:38:INFO:sockeye.utils:log_mxnet_version] MXNet version 1.4.0, path /usr/local/lib/python3.6/dist-packages/mxnet/__init__.py
[2019-05-20:15:34:38:INFO:sockeye.utils:log_basic_info] Command: /notebooks/sockeye/sockeye/train.py --source test_data/source_train.txt --target test_data/target_train.txt --validation-source test_data/source_test.txt --validation-target test_data/target_test.txt --encoder rnn --decoder rnn --num-layers 2:2 --num-embed 32 --rnn-num-hidden 512 --rnn-attention-type dot --metrics perplexity accuracy --max-num-checkpoint-not-improved 3 --initial-learning-rate 0.0002 --max-seq-len 100 --output new_model --overwrite-output
[2019-05-20:15:34:38:INFO:sockeye.utils:log_basic_info] Arguments: Namespace(allow_missing_params=False, batch_size=4096, batch_type='word', bucket_width=10, checkpoint_interval=4000, cnn_activation_type='glu', cnn_hidden_dropout=0.2, cnn_kernel_width=(3, 3), cnn_num_hidden=512, cnn_positional_embedding_type='learned', cnn_project_qkv=False, config=None, conv_embed_add_positional_encodings=False, conv_embed_dropout=0.0, conv_embed_max_filter_width=8, conv_embed_num_filters=(200, 200, 250, 250, 300, 300, 300, 300), conv_embed_num_highway_layers=4, conv_embed_output_dim=None, conv_embed_pool_stride=5, decode_and_evaluate=500, decode_and_evaluate_device_id=None, decode_and_evaluate_use_cpu=False, decoder='rnn', decoder_only=False, device_ids=[-1], disable_device_locking=False, dry_run=False, embed_dropout=(0.0, 0.0), embed_weight_init='default', encoder='rnn', fixed_param_names=[], fixed_param_strategy=None, gradient_clipping_threshold=1.0, gradient_clipping_type='none', gradient_compression_threshold=0.5, gradient_compression_type=None, initial_learning_rate=0.0002, keep_initializations=False, keep_last_params=-1, kvstore='device', label_smoothing=0.1, layer_normalization=False, learning_rate_decay_optimizer_states_reset='off', learning_rate_decay_param_reset=False, learning_rate_half_life=10, learning_rate_reduce_factor=0.7, learning_rate_reduce_num_not_improved=8, learning_rate_schedule=None, learning_rate_scheduler_type='plateau-reduce', learning_rate_warmup=0, length_task=None, length_task_layers=1, length_task_weight=1.0, lhuc=None, lock_dir='/tmp', loglevel='INFO', loss='cross-entropy', loss_normalization_type='valid', max_checkpoints=None, max_num_checkpoint_not_improved=3, max_num_epochs=None, max_samples=None, max_seq_len=(100, 100), max_updates=None, metrics=['perplexity', 'accuracy'], min_num_epochs=None, min_samples=None, min_updates=None, momentum=None, monitor_pattern=None, monitor_stat_func='mx_default', no_bucketing=False, num_embed=(32, 32), num_layers=(2, 2), num_words=(0, 0), optimized_metric='perplexity', optimizer='adam', optimizer_params=None, output='new_model', overwrite_output=True, pad_vocab_to_multiple_of=None, params=None, prepared_data=None, quiet=False, rnn_attention_coverage_max_fertility=2, rnn_attention_coverage_num_hidden=1, rnn_attention_coverage_type='count', rnn_attention_in_upper_layers=False, rnn_attention_mhdot_heads=None, rnn_attention_num_hidden=None, rnn_attention_type='dot', rnn_attention_use_prev_word=False, rnn_cell_type='lstm', rnn_context_gating=False, rnn_decoder_hidden_dropout=0.2, rnn_decoder_state_init='last', rnn_dropout_inputs=(0.0, 0.0), rnn_dropout_recurrent=(0.0, 0.0), rnn_dropout_states=(0.0, 0.0), rnn_enc_last_hidden_concat_to_embedding=False, rnn_encoder_reverse_input=False, rnn_first_residual_layer=2, rnn_forget_bias=0.0, rnn_h2h_init='orthogonal', rnn_num_hidden=512, rnn_residual_connections=False, rnn_scale_dot_attention=False, seed=13, shared_vocab=False, source='test_data/source_train.txt', source_factor_vocabs=[], source_factors=[], source_factors_combine='concat', source_factors_num_embed=[], source_vocab=None, stop_training_on_decoder_failure=False, target='test_data/target_train.txt', target_vocab=None, transformer_activation_type='relu', transformer_attention_heads=(8, 8), transformer_dropout_act=0.1, transformer_dropout_attention=0.1, transformer_dropout_prepost=0.1, transformer_feed_forward_num_hidden=(2048, 2048), transformer_model_size=(512, 512), transformer_positional_embedding_type='fixed', transformer_postprocess=('dr', 'dr'), transformer_preprocess=('n', 'n'), update_interval=1, use_cpu=False, validation_source='test_data/source_test.txt', validation_source_factors=[], validation_target='test_data/target_test.txt', weight_decay=0.0, weight_init='xavier', weight_init_scale=3.0, weight_init_xavier_factor_type='avg', weight_init_xavier_rand_type='uniform', weight_normalization=False, weight_tying=False, weight_tying_type='trg_softmax', word_min_count=(1, 1))
[2019-05-20:15:34:38:INFO:__main__:train] Adjusting maximum length to reserve space for a BOS/EOS marker. New maximum length: (101, 101)
[2019-05-20:15:34:38:INFO:sockeye.utils:acquire_gpus] Attempting to acquire 1 GPUs of 1 GPUs. The requested devices are: [-1]
[2019-05-20:15:34:38:INFO:sockeye.utils:__enter__] Acquired GPU master_lock.
[2019-05-20:15:34:38:INFO:sockeye.utils:__enter__] Acquired GPU 0.
[2019-05-20:15:34:38:INFO:sockeye.utils:__exit__] Releasing GPU master_lock.
[2019-05-20:15:34:38:INFO:__main__:train] Training Device(s): gpu(0)
[2019-05-20:15:34:38:INFO:sockeye.vocab:load_or_create_vocabs] =============================
[2019-05-20:15:34:38:INFO:sockeye.vocab:load_or_create_vocabs] Loading/creating vocabularies
[2019-05-20:15:34:38:INFO:sockeye.vocab:load_or_create_vocabs] =============================
[2019-05-20:15:34:38:INFO:sockeye.vocab:load_or_create_vocabs] (1) Surface form vocabularies (source & target)
[2019-05-20:15:34:38:INFO:sockeye.vocab:build_from_paths] Building vocabulary from dataset(s): ['test_data/source_train.txt']
[2019-05-20:15:34:43:INFO:sockeye.vocab:build_vocab] Vocabulary: types: 1065/1065/1065/1069 (initial/min_pruned/max_pruned/+special) [min_frequency=1, max_num_types=None, pad_to_multiple_of=None]
[2019-05-20:15:34:43:INFO:sockeye.vocab:build_from_paths] Building vocabulary from dataset(s): ['test_data/target_train.txt']
[2019-05-20:15:34:47:INFO:sockeye.vocab:build_vocab] Vocabulary: types: 1148/1148/1148/1152 (initial/min_pruned/max_pruned/+special) [min_frequency=1, max_num_types=None, pad_to_multiple_of=None]
[2019-05-20:15:34:47:INFO:sockeye.data_io:get_training_data_iters] ===============================
[2019-05-20:15:34:47:INFO:sockeye.data_io:get_training_data_iters] Creating training data iterator
[2019-05-20:15:34:47:INFO:sockeye.data_io:get_training_data_iters] ===============================
[2019-05-20:15:34:58:WARNING:sockeye.data_io:parallel_iterate] Parallel reading of sequences skipped 568 elements
[2019-05-20:15:34:58:INFO:sockeye.data_io:analyze_sequence_lengths] 7919 sequences of maximum length (101, 101) in '/notebooks/sockeye/test_data/source_train.txt' and '/notebooks/sockeye/test_data/target_train.txt'.
[2019-05-20:15:34:58:INFO:sockeye.data_io:analyze_sequence_lengths] Mean training target/source length ratio: 0.96 (+-0.05)
[2019-05-20:15:35:09:WARNING:sockeye.data_io:parallel_iterate] Parallel reading of sequences skipped 568 elements
[2019-05-20:15:35:09:INFO:sockeye.data_io:log] Tokens: source 360790 target 338847
[2019-05-20:15:35:09:INFO:sockeye.data_io:log] Vocabulary coverage: source 100% target 100%
[2019-05-20:15:35:09:INFO:sockeye.data_io:log] 7919 sequences across 11 buckets
[2019-05-20:15:35:09:INFO:sockeye.data_io:log] 77092 sequences did not fit into buckets and were discarded
[2019-05-20:15:35:09:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (10, 10): 1921 samples in 4 batches of 637, ~4097.6 tokens/batch, trg/src length ratio: 1.00 (+-0.00)
[2019-05-20:15:35:09:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (20, 20): 882 samples in 4 batches of 287, ~4102.3 tokens/batch, trg/src length ratio: 0.96 (+-0.06)
[2019-05-20:15:35:09:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (30, 30): 331 samples in 3 batches of 165, ~4102.6 tokens/batch, trg/src length ratio: 0.97 (+-0.05)
[2019-05-20:15:35:09:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (40, 40): 693 samples in 6 batches of 123, ~4104.8 tokens/batch, trg/src length ratio: 0.93 (+-0.05)
[2019-05-20:15:35:09:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (50, 50): 529 samples in 6 batches of 95, ~4105.5 tokens/batch, trg/src length ratio: 0.95 (+-0.05)
[2019-05-20:15:35:09:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (60, 60): 543 samples in 7 batches of 78, ~4092.8 tokens/batch, trg/src length ratio: 0.95 (+-0.04)
[2019-05-20:15:35:09:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (70, 70): 417 samples in 7 batches of 66, ~4079.2 tokens/batch, trg/src length ratio: 0.94 (+-0.04)
[2019-05-20:15:35:09:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (80, 80): 1161 samples in 21 batches of 57, ~4085.5 tokens/batch, trg/src length ratio: 0.93 (+-0.03)
[2019-05-20:15:35:09:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (90, 90): 629 samples in 13 batches of 52, ~4115.3 tokens/batch, trg/src length ratio: 0.93 (+-0.04)
[2019-05-20:15:35:09:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (100, 100): 751 samples in 17 batches of 46, ~4069.8 tokens/batch, trg/src length ratio: 0.93 (+-0.04)
[2019-05-20:15:35:09:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (101, 101): 62 samples in 1 batches of 64, ~6154.3 tokens/batch, trg/src length ratio: 0.95 (+-0.04)
[2019-05-20:15:35:20:WARNING:sockeye.data_io:parallel_iterate] Parallel reading of sequences skipped 568 elements
[2019-05-20:15:35:20:INFO:sockeye.data_io:load] Created bucketed parallel data set. Introduced padding: source=8.3% target=13.9%)
[2019-05-20:15:35:20:INFO:sockeye.data_io:get_validation_data_iter] =================================
[2019-05-20:15:35:20:INFO:sockeye.data_io:get_validation_data_iter] Creating validation data iterator
[2019-05-20:15:35:20:INFO:sockeye.data_io:get_validation_data_iter] =================================
[2019-05-20:15:35:23:WARNING:sockeye.data_io:parallel_iterate] Parallel reading of sequences skipped 331 elements
[2019-05-20:15:35:23:INFO:sockeye.data_io:analyze_sequence_lengths] 1449 sequences of maximum length (101, 101) in '/notebooks/sockeye/test_data/source_test.txt' and '/notebooks/sockeye/test_data/target_test.txt'.
[2019-05-20:15:35:23:INFO:sockeye.data_io:analyze_sequence_lengths] Mean training target/source length ratio: 0.97 (+-0.04)
[2019-05-20:15:35:26:WARNING:sockeye.data_io:parallel_iterate] Parallel reading of sequences skipped 331 elements
[2019-05-20:15:35:26:INFO:sockeye.data_io:log] Tokens: source 62137 target 58983
[2019-05-20:15:35:26:INFO:sockeye.data_io:log] Vocabulary coverage: source 100% target 100%
[2019-05-20:15:35:26:INFO:sockeye.data_io:log] 1449 sequences across 11 buckets
[2019-05-20:15:35:26:INFO:sockeye.data_io:log] 19615 sequences did not fit into buckets and were discarded
[2019-05-20:15:35:26:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (10, 10): 427 samples in 1 batches of 637, ~4097.6 tokens/batch, trg/src length ratio: 1.00 (+-0.00)
[2019-05-20:15:35:26:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (20, 20): 117 samples in 1 batches of 287, ~4102.3 tokens/batch, trg/src length ratio: 0.99 (+-0.03)
[2019-05-20:15:35:26:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (30, 30): 60 samples in 1 batches of 165, ~4102.6 tokens/batch, trg/src length ratio: 0.97 (+-0.05)
[2019-05-20:15:35:26:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (40, 40): 110 samples in 1 batches of 123, ~4104.8 tokens/batch, trg/src length ratio: 0.96 (+-0.05)
[2019-05-20:15:35:26:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (50, 50): 101 samples in 2 batches of 95, ~4105.5 tokens/batch, trg/src length ratio: 0.95 (+-0.05)
[2019-05-20:15:35:26:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (60, 60): 128 samples in 2 batches of 78, ~4092.8 tokens/batch, trg/src length ratio: 0.95 (+-0.04)
[2019-05-20:15:35:26:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (70, 70): 114 samples in 2 batches of 66, ~4079.2 tokens/batch, trg/src length ratio: 0.95 (+-0.04)
[2019-05-20:15:35:26:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (80, 80): 146 samples in 3 batches of 57, ~4085.5 tokens/batch, trg/src length ratio: 0.95 (+-0.04)
[2019-05-20:15:35:26:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (90, 90): 120 samples in 3 batches of 52, ~4115.3 tokens/batch, trg/src length ratio: 0.94 (+-0.04)
[2019-05-20:15:35:26:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (100, 100): 119 samples in 3 batches of 46, ~4069.8 tokens/batch, trg/src length ratio: 0.94 (+-0.04)
[2019-05-20:15:35:26:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (101, 101): 7 samples in 1 batches of 64, ~6154.3 tokens/batch, trg/src length ratio: 0.93 (+-0.04)
[2019-05-20:15:35:28:WARNING:sockeye.data_io:parallel_iterate] Parallel reading of sequences skipped 331 elements
[2019-05-20:15:35:28:INFO:sockeye.data_io:load] Created bucketed parallel data set. Introduced padding: source=9.4% target=14.0%)
[2019-05-20:15:35:28:INFO:__main__:create_data_iters_and_vocabs] Writing data config to '/notebooks/sockeye/new_model/data.info'
[2019-05-20:15:35:28:INFO:sockeye.vocab:vocab_to_json] Vocabulary saved to "/notebooks/sockeye/new_model/vocab.src.0.json"
[2019-05-20:15:35:29:INFO:sockeye.vocab:vocab_to_json] Vocabulary saved to "/notebooks/sockeye/new_model/vocab.trg.0.json"
[2019-05-20:15:35:29:INFO:__main__:train] Vocabulary sizes: source=[1069] target=1152
[2019-05-20:15:35:29:INFO:sockeye.model:__init__] Config[_frozen=True, config_data=Config[_frozen=True, data_statistics=Config[_frozen=True, average_len_target_per_bucket=[6.432587194169709, 14.293650793650793, 24.864048338368576, 33.372294372294405, 43.2155009451796, 52.47145488029471, 61.80575539568343, 71.67527993109395, 79.13990461049289, 88.474034620506, 96.16129032258064], buckets=[(10, 10), (20, 20), (30, 30), (40, 40), (50, 50), (60, 60), (70, 70), (80, 80), (90, 90), (100, 100), (101, 101)], length_ratio_mean=0.9562659069658344, length_ratio_stats_per_bucket=[(0.9998958875585643, 0.004561978615347545), (0.9636921881415731, 0.0558779116540519), (0.9675630719236029, 0.05037692493004406), (0.9338014968601602, 0.04594605630952041), (0.9451020852972198, 0.04972788759404983), (0.9503303248247427, 0.04024988241285883), (0.9438011832078682, 0.04350991029928626), (0.9341934541544231, 0.032520771495413214), (0.9311161655799235, 0.04075587357915276), (0.9263003447372451, 0.03912604513122222), (0.9520919833918876, 0.04040211173869309)], length_ratio_std=0.04698753548625022, max_observed_len_source=101, max_observed_len_target=101, num_discarded=77092, num_sents=7919, num_sents_per_bucket=[1921, 882, 331, 693, 529, 543, 417, 1161, 629, 751, 62], num_tokens_source=360790, num_tokens_target=338847, num_unks_source=0, num_unks_target=0, size_vocab_source=1069, size_vocab_target=1152], max_seq_len_source=101, max_seq_len_target=101, num_source_factors=1, source_with_eos=True], config_decoder=Config[_frozen=True, attention_config=Config[_frozen=True, config_coverage=None, dtype=float32, input_previous_word=False, is_scaled=False, layer_normalization=False, num_heads=None, num_hidden=512, query_num_hidden=512, source_num_hidden=512, type=dot], attention_in_upper_layers=False, context_gating=False, dtype=float32, enc_last_hidden_concat_to_embedding=False, hidden_dropout=0.2, layer_normalization=False, max_seq_len_source=101, rnn_config=Config[_frozen=True, cell_type=lstm, dropout_inputs=0.0, dropout_recurrent=0.0, dropout_states=0.0, dtype=float32, first_residual_layer=2, forget_bias=0.0, lhuc=False, num_hidden=512, num_layers=2, residual=False], state_init=last, state_init_lhuc=False], config_embed_source=Config[_frozen=True, dropout=0.0, dtype=float32, factor_configs=None, num_embed=32, num_factors=1, source_factors_combine=concat, vocab_size=1069], config_embed_target=Config[_frozen=True, dropout=0.0, dtype=float32, factor_configs=None, num_embed=32, num_factors=1, source_factors_combine=concat, vocab_size=1152], config_encoder=Config[_frozen=True, conv_config=None, dtype=float32, reverse_input=False, rnn_config=Config[_frozen=True, cell_type=lstm, dropout_inputs=0.0, dropout_recurrent=0.0, dropout_states=0.0, dtype=float32, first_residual_layer=2, forget_bias=0.0, lhuc=False, num_hidden=512, num_layers=2, residual=False]], config_length_task=None, config_length_task_loss=None, config_loss=Config[_frozen=True, label_smoothing=0.1, length_task_link=None, length_task_weight=1.0, name=cross-entropy, normalization_type=valid, vocab_size=1152], lhuc=False, vocab_source_size=1069, vocab_target_size=1152, weight_normalization=False, weight_tying=False, weight_tying_type=None]
[2019-05-20:15:35:29:INFO:sockeye.encoder:__init__] sockeye.encoder.EncoderSequence dtype: float32
[2019-05-20:15:35:29:INFO:sockeye.encoder:__init__] sockeye.encoder.ConvertLayout dtype: float32
[2019-05-20:15:35:29:INFO:sockeye.encoder:__init__] sockeye.encoder.BiDirectionalRNNEncoder dtype: float32
[2019-05-20:15:35:29:INFO:sockeye.encoder:__init__] sockeye.encoder.RecurrentEncoder dtype: float32
[2019-05-20:15:35:29:INFO:sockeye.encoder:__init__] sockeye.encoder.RecurrentEncoder dtype: float32
[2019-05-20:15:35:29:INFO:sockeye.encoder:__init__] sockeye.encoder.RecurrentEncoder dtype: float32
[2019-05-20:15:35:29:INFO:sockeye.encoder:__init__] sockeye.encoder.ConvertLayout dtype: float32
[2019-05-20:15:35:29:INFO:sockeye.decoder:__init__] sockeye.decoder.RecurrentDecoder dtype: float32
[2019-05-20:15:35:29:INFO:sockeye.encoder:__init__] sockeye.encoder.Embedding dtype: float32
[2019-05-20:15:35:29:INFO:sockeye.encoder:__init__] sockeye.encoder.Embedding dtype: float32
[2019-05-20:15:35:29:INFO:sockeye.loss:__init__] Loss: CrossEntropy(normalization_type=valid, label_smoothing=0.1)
[2019-05-20:15:35:29:INFO:sockeye.training:_initialize] Using model loss: cross-entropy
[2019-05-20:15:35:29:INFO:sockeye.training:_initialize] Using bucketing. Default max_seq_len=(101, 101)
[2019-05-20:15:35:33:INFO:sockeye.model:save_config] Saved config to "/notebooks/sockeye/new_model/config"
[2019-05-20:15:35:33:INFO:sockeye.lr_scheduler:__init__] Will reduce the learning rate by a factor of 0.70 whenever the validation score doesn't improve 8 times.
[2019-05-20:15:35:33:INFO:__main__:create_optimizer_config] Optimizer: Config[_frozen=False, gradient_clipping_threshold=1.0, gradient_clipping_type=none, initializer=<mxnet.initializer.Mixed object at 0x7f0187a2a198>, kvstore=device, name=adam, params={'wd': 0.0, 'learning_rate': 0.0002, 'rescale_grad': 1.0, 'lr_scheduler': LearningRateSchedulerPlateauReduce(reduce_factor=0.70, reduce_num_not_improved=0)}, update_interval=1]
[2019-05-20:15:35:33:INFO:__main__:create_optimizer_config] Gradient Compression: None
[2019-05-20:15:35:33:INFO:sockeye.training:__init__] Logging training events for Tensorboard at '/notebooks/sockeye/new_model/tensorboard'
[2019-05-20:15:35:33:INFO:sockeye.checkpoint_decoder:__init__] Created CheckpointDecoder(max_input_len=-1, beam_size=5, model=new_model, num_sentences=500, context=gpu(0))
[2019-05-20:15:35:33:INFO:sockeye.training:fit] Early stopping by optimizing 'perplexity'
[2019-05-20:15:35:35:INFO:sockeye.training:log_parameters] Model parameters: decoder_rnn_enc2decinit_0_bias: (512,), decoder_rnn_enc2decinit_0_weight: (512, 512), decoder_rnn_enc2decinit_1_bias: (512,), decoder_rnn_enc2decinit_1_weight: (512, 512), decoder_rnn_enc2decinit_2_bias: (512,), decoder_rnn_enc2decinit_2_weight: (512, 512), decoder_rnn_enc2decinit_3_bias: (512,), decoder_rnn_enc2decinit_3_weight: (512, 512), decoder_rnn_hidden_bias: (512,), decoder_rnn_hidden_weight: (512, 1024), decoder_rnn_l0_h2h_bias: (2048,), decoder_rnn_l0_h2h_weight: (2048, 512), decoder_rnn_l0_i2h_bias: (2048,), decoder_rnn_l0_i2h_weight: (2048, 544), decoder_rnn_l1_h2h_bias: (2048,), decoder_rnn_l1_h2h_weight: (2048, 512), decoder_rnn_l1_i2h_bias: (2048,), decoder_rnn_l1_i2h_weight: (2048, 512), encoder_birnn_forward_l0_h2h_bias: (1024,), encoder_birnn_forward_l0_h2h_weight: (1024, 256), encoder_birnn_forward_l0_i2h_bias: (1024,), encoder_birnn_forward_l0_i2h_weight: (1024, 32), encoder_birnn_reverse_l0_h2h_bias: (1024,), encoder_birnn_reverse_l0_h2h_weight: (1024, 256), encoder_birnn_reverse_l0_i2h_bias: (1024,), encoder_birnn_reverse_l0_i2h_weight: (1024, 32), encoder_rnn_l0_h2h_bias: (2048,), encoder_rnn_l0_h2h_weight: (2048, 512), encoder_rnn_l0_i2h_bias: (2048,), encoder_rnn_l0_i2h_weight: (2048, 512), source_embed_weight: (1069, 32), target_embed_weight: (1152, 32), target_output_bias: (1152,), target_output_weight: (1152, 512)
[2019-05-20:15:35:35:INFO:sockeye.training:log_parameters] Fixed model parameters: 
[2019-05-20:15:35:35:INFO:sockeye.training:log_parameters] Fixing 0 parameters (0.00%)
[2019-05-20:15:35:35:INFO:sockeye.training:log_parameters] Learning 9200672 parameters (100.00%)
[2019-05-20:15:35:35:INFO:sockeye.training:log_parameters] Total # of parameters: 9200672
[2019-05-20:15:35:35:INFO:root:save_params_to_file] Saved params to "/notebooks/sockeye/new_model/params.00000"
[2019-05-20:15:35:36:INFO:sockeye.training:fit] Training started.
[2019-05-20:15:36:00:INFO:sockeye.training:__call__] Epoch[0] Batch [50]	Speed: 236.98 samples/sec 10645.92 tokens/sec 2.21 updates/sec	perplexity=174.497912	accuracy=0.114719
[2019-05-20:15:36:14:INFO:sockeye.training:__call__] Epoch[1] Batch [100]	Speed: 327.91 samples/sec 16695.40 tokens/sec 3.50 updates/sec	perplexity=103.166209	accuracy=0.119209
[2019-05-20:15:36:28:INFO:sockeye.training:__call__] Epoch[1] Batch [150]	Speed: 386.56 samples/sec 16959.33 tokens/sec 3.51 updates/sec	perplexity=85.798752	accuracy=0.121814
[2019-05-20:15:36:43:INFO:sockeye.training:__call__] Epoch[2] Batch [200]	Speed: 305.57 samples/sec 16464.35 tokens/sec 3.47 updates/sec	perplexity=78.224767	accuracy=0.121548
[2019-05-20:15:36:57:INFO:sockeye.training:__call__] Epoch[2] Batch [250]	Speed: 419.68 samples/sec 16897.99 tokens/sec 3.50 updates/sec	perplexity=72.804064	accuracy=0.124954
[2019-05-20:15:37:11:INFO:sockeye.training:__call__] Epoch[3] Batch [300]	Speed: 429.79 samples/sec 17984.93 tokens/sec 3.70 updates/sec	perplexity=69.001440	accuracy=0.126332
[2019-05-20:15:37:24:INFO:sockeye.training:__call__] Epoch[3] Batch [350]	Speed: 339.62 samples/sec 17242.24 tokens/sec 3.59 updates/sec	perplexity=66.138973	accuracy=0.126287
[2019-05-20:15:37:39:INFO:sockeye.training:__call__] Epoch[4] Batch [400]	Speed: 401.78 samples/sec 17141.33 tokens/sec 3.54 updates/sec	perplexity=63.071461	accuracy=0.127693
[2019-05-20:15:37:54:INFO:sockeye.training:__call__] Epoch[5] Batch [450]	Speed: 315.71 samples/sec 15565.99 tokens/sec 3.27 updates/sec	perplexity=60.849066	accuracy=0.127953
[2019-05-20:15:38:09:INFO:sockeye.training:__call__] Epoch[5] Batch [500]	Speed: 313.14 samples/sec 15642.27 tokens/sec 3.30 updates/sec	perplexity=58.903403	accuracy=0.128330
[2019-05-20:15:38:25:INFO:sockeye.training:__call__] Epoch[6] Batch [550]	Speed: 299.78 samples/sec 15426.55 tokens/sec 3.21 updates/sec	perplexity=57.383891	accuracy=0.128678
[2019-05-20:15:38:40:INFO:sockeye.training:__call__] Epoch[6] Batch [600]	Speed: 381.58 samples/sec 15854.62 tokens/sec 3.25 updates/sec	perplexity=55.610403	accuracy=0.129707
[2019-05-20:15:38:55:INFO:sockeye.training:__call__] Epoch[7] Batch [650]	Speed: 386.65 samples/sec 16313.29 tokens/sec 3.38 updates/sec	perplexity=53.965692	accuracy=0.130747
[2019-05-20:15:39:10:INFO:sockeye.training:__call__] Epoch[7] Batch [700]	Speed: 316.71 samples/sec 15453.10 tokens/sec 3.25 updates/sec	perplexity=52.580041	accuracy=0.131649
[2019-05-20:15:39:26:INFO:sockeye.training:__call__] Epoch[8] Batch [750]	Speed: 263.18 samples/sec 14833.06 tokens/sec 3.12 updates/sec	perplexity=51.223677	accuracy=0.133068
[2019-05-20:15:39:41:INFO:sockeye.training:__call__] Epoch[8] Batch [800]	Speed: 387.59 samples/sec 16025.08 tokens/sec 3.29 updates/sec	perplexity=49.521356	accuracy=0.137010
[2019-05-20:15:39:58:INFO:sockeye.training:__call__] Epoch[9] Batch [850]	Speed: 361.14 samples/sec 14995.15 tokens/sec 3.10 updates/sec	perplexity=47.759780	accuracy=0.141739
[2019-05-20:15:40:13:INFO:sockeye.training:__call__] Epoch[10] Batch [900]	Speed: 365.53 samples/sec 15946.45 tokens/sec 3.30 updates/sec	perplexity=46.044082	accuracy=0.146616
[2019-05-20:15:40:28:INFO:sockeye.training:__call__] Epoch[10] Batch [950]	Speed: 289.86 samples/sec 15425.28 tokens/sec 3.22 updates/sec	perplexity=44.395181	accuracy=0.152023
[2019-05-20:15:40:44:INFO:sockeye.training:__call__] Epoch[11] Batch [1000]	Speed: 314.85 samples/sec 15487.49 tokens/sec 3.26 updates/sec	perplexity=42.755735	accuracy=0.158743
[2019-05-20:15:40:59:INFO:sockeye.training:__call__] Epoch[11] Batch [1050]	Speed: 305.66 samples/sec 15750.40 tokens/sec 3.28 updates/sec	perplexity=41.166987	accuracy=0.165879
[2019-05-20:15:41:14:INFO:sockeye.training:__call__] Epoch[12] Batch [1100]	Speed: 365.84 samples/sec 15882.91 tokens/sec 3.31 updates/sec	perplexity=39.630611	accuracy=0.172854
[2019-05-20:15:41:29:INFO:sockeye.training:__call__] Epoch[12] Batch [1150]	Speed: 373.20 samples/sec 15882.89 tokens/sec 3.30 updates/sec	perplexity=38.090136	accuracy=0.180849
[2019-05-20:15:41:45:INFO:sockeye.training:__call__] Epoch[13] Batch [1200]	Speed: 234.79 samples/sec 14520.09 tokens/sec 3.05 updates/sec	perplexity=36.605718	accuracy=0.189178
[2019-05-20:15:41:59:INFO:sockeye.training:__call__] Epoch[14] Batch [1250]	Speed: 454.93 samples/sec 17521.66 tokens/sec 3.59 updates/sec	perplexity=35.163378	accuracy=0.198035
[2019-05-20:15:42:14:INFO:sockeye.training:__call__] Epoch[14] Batch [1300]	Speed: 334.92 samples/sec 16034.40 tokens/sec 3.34 updates/sec	perplexity=33.759524	accuracy=0.207253
[2019-05-20:15:42:30:INFO:sockeye.training:__call__] Epoch[15] Batch [1350]	Speed: 324.84 samples/sec 14960.77 tokens/sec 3.13 updates/sec	perplexity=32.510662	accuracy=0.215438
[2019-05-20:15:42:45:INFO:sockeye.training:__call__] Epoch[15] Batch [1400]	Speed: 347.59 samples/sec 16717.79 tokens/sec 3.48 updates/sec	perplexity=31.197901	accuracy=0.225001
[2019-05-20:15:42:58:INFO:sockeye.training:__call__] Epoch[16] Batch [1450]	Speed: 461.14 samples/sec 18045.10 tokens/sec 3.71 updates/sec	perplexity=30.001264	accuracy=0.234132
[2019-05-20:15:43:13:INFO:sockeye.training:__call__] Epoch[16] Batch [1500]	Speed: 295.41 samples/sec 15999.26 tokens/sec 3.36 updates/sec	perplexity=28.886715	accuracy=0.242927
[2019-05-20:15:43:27:INFO:sockeye.training:__call__] Epoch[17] Batch [1550]	Speed: 375.75 samples/sec 16924.76 tokens/sec 3.49 updates/sec	perplexity=27.840595	accuracy=0.251385
[2019-05-20:15:43:41:INFO:sockeye.training:__call__] Epoch[17] Batch [1600]	Speed: 319.76 samples/sec 16860.91 tokens/sec 3.55 updates/sec	perplexity=26.850349	accuracy=0.259671
[2019-05-20:15:43:55:INFO:sockeye.training:__call__] Epoch[18] Batch [1650]	Speed: 415.94 samples/sec 17161.23 tokens/sec 3.55 updates/sec	perplexity=25.804044	accuracy=0.268880
[2019-05-20:15:44:10:INFO:sockeye.training:__call__] Epoch[19] Batch [1700]	Speed: 349.17 samples/sec 16836.89 tokens/sec 3.50 updates/sec	perplexity=24.956082	accuracy=0.276457
[2019-05-20:15:44:24:INFO:sockeye.training:__call__] Epoch[19] Batch [1750]	Speed: 458.12 samples/sec 17655.11 tokens/sec 3.64 updates/sec	perplexity=24.067569	accuracy=0.284773
[2019-05-20:15:44:38:INFO:sockeye.training:__call__] Epoch[20] Batch [1800]	Speed: 262.68 samples/sec 15934.86 tokens/sec 3.37 updates/sec	perplexity=23.289812	accuracy=0.292078
[2019-05-20:15:44:52:INFO:sockeye.training:__call__] Epoch[20] Batch [1850]	Speed: 425.43 samples/sec 17679.60 tokens/sec 3.63 updates/sec	perplexity=22.547801	accuracy=0.299251
[2019-05-20:15:45:07:INFO:sockeye.training:__call__] Epoch[21] Batch [1900]	Speed: 244.52 samples/sec 15890.55 tokens/sec 3.39 updates/sec	perplexity=21.865034	accuracy=0.306173
[2019-05-20:15:45:21:INFO:sockeye.training:__call__] Epoch[21] Batch [1950]	Speed: 434.19 samples/sec 17115.82 tokens/sec 3.54 updates/sec	perplexity=21.252689	accuracy=0.312366
[2019-05-20:15:45:36:INFO:sockeye.training:__call__] Epoch[22] Batch [2000]	Speed: 359.74 samples/sec 16102.07 tokens/sec 3.34 updates/sec	perplexity=20.642558	accuracy=0.318733
[2019-05-20:15:45:50:INFO:sockeye.training:__call__] Epoch[23] Batch [2050]	Speed: 351.01 samples/sec 17006.69 tokens/sec 3.52 updates/sec	perplexity=20.035030	accuracy=0.325370
[2019-05-20:15:46:04:INFO:sockeye.training:__call__] Epoch[23] Batch [2100]	Speed: 407.18 samples/sec 17139.17 tokens/sec 3.52 updates/sec	perplexity=19.487465	accuracy=0.331435
[2019-05-20:15:46:18:INFO:sockeye.training:__call__] Epoch[24] Batch [2150]	Speed: 359.26 samples/sec 17144.94 tokens/sec 3.60 updates/sec	perplexity=18.955167	accuracy=0.337487
[2019-05-20:15:46:32:INFO:sockeye.training:__call__] Epoch[24] Batch [2200]	Speed: 369.13 samples/sec 17010.28 tokens/sec 3.52 updates/sec	perplexity=18.429886	accuracy=0.343629
[2019-05-20:15:46:47:INFO:sockeye.training:__call__] Epoch[25] Batch [2250]	Speed: 298.50 samples/sec 16531.62 tokens/sec 3.50 updates/sec	perplexity=17.980351	accuracy=0.348945
[2019-05-20:15:47:01:INFO:sockeye.training:__call__] Epoch[25] Batch [2300]	Speed: 400.48 samples/sec 17056.77 tokens/sec 3.51 updates/sec	perplexity=17.613937	accuracy=0.353283
[2019-05-20:15:47:15:INFO:sockeye.training:__call__] Epoch[26] Batch [2350]	Speed: 356.74 samples/sec 16537.80 tokens/sec 3.46 updates/sec	perplexity=17.207772	accuracy=0.358329
[2019-05-20:15:47:29:INFO:sockeye.training:__call__] Epoch[26] Batch [2400]	Speed: 383.15 samples/sec 17354.41 tokens/sec 3.59 updates/sec	perplexity=16.788194	accuracy=0.363723
[2019-05-20:15:47:44:INFO:sockeye.training:__call__] Epoch[27] Batch [2450]	Speed: 313.20 samples/sec 16683.23 tokens/sec 3.49 updates/sec	perplexity=16.434256	accuracy=0.368303
[2019-05-20:15:47:58:INFO:sockeye.training:__call__] Epoch[28] Batch [2500]	Speed: 417.43 samples/sec 16758.80 tokens/sec 3.47 updates/sec	perplexity=16.045559	accuracy=0.373526
[2019-05-20:15:48:12:INFO:sockeye.training:__call__] Epoch[28] Batch [2550]	Speed: 273.28 samples/sec 16489.67 tokens/sec 3.48 updates/sec	perplexity=15.675440	accuracy=0.378583
[2019-05-20:15:48:27:INFO:sockeye.training:__call__] Epoch[29] Batch [2600]	Speed: 401.18 samples/sec 16971.64 tokens/sec 3.51 updates/sec	perplexity=15.359016	accuracy=0.382980
[2019-05-20:15:48:41:INFO:sockeye.training:__call__] Epoch[29] Batch [2650]	Speed: 402.35 samples/sec 17419.77 tokens/sec 3.60 updates/sec	perplexity=15.038803	accuracy=0.387463
[2019-05-20:15:48:55:INFO:sockeye.training:__call__] Epoch[30] Batch [2700]	Speed: 313.83 samples/sec 16713.25 tokens/sec 3.52 updates/sec	perplexity=14.746999	accuracy=0.391620
[2019-05-20:15:49:09:INFO:sockeye.training:__call__] Epoch[30] Batch [2750]	Speed: 431.85 samples/sec 17352.73 tokens/sec 3.57 updates/sec	perplexity=14.452394	accuracy=0.395924
[2019-05-20:15:49:23:INFO:sockeye.training:__call__] Epoch[31] Batch [2800]	Speed: 331.73 samples/sec 16862.62 tokens/sec 3.52 updates/sec	perplexity=14.184027	accuracy=0.399914
[2019-05-20:15:49:37:INFO:sockeye.training:__call__] Epoch[32] Batch [2850]	Speed: 385.10 samples/sec 16735.06 tokens/sec 3.48 updates/sec	perplexity=13.905384	accuracy=0.404185
[2019-05-20:15:49:52:INFO:sockeye.training:__call__] Epoch[32] Batch [2900]	Speed: 341.65 samples/sec 16711.78 tokens/sec 3.51 updates/sec	perplexity=13.650352	accuracy=0.408136
[2019-05-20:15:50:06:INFO:sockeye.training:__call__] Epoch[33] Batch [2950]	Speed: 386.98 samples/sec 17109.78 tokens/sec 3.52 updates/sec	perplexity=13.425553	accuracy=0.411630
[2019-05-20:15:50:19:INFO:sockeye.training:__call__] Epoch[33] Batch [3000]	Speed: 384.37 samples/sec 17699.49 tokens/sec 3.70 updates/sec	perplexity=13.194290	accuracy=0.415341
[2019-05-20:15:50:34:INFO:sockeye.training:__call__] Epoch[34] Batch [3050]	Speed: 361.49 samples/sec 16862.37 tokens/sec 3.51 updates/sec	perplexity=12.961878	accuracy=0.419134
[2019-05-20:15:50:47:INFO:sockeye.training:__call__] Epoch[34] Batch [3100]	Speed: 435.58 samples/sec 17879.45 tokens/sec 3.70 updates/sec	perplexity=12.745400	accuracy=0.422725
[2019-05-20:15:51:02:INFO:sockeye.training:__call__] Epoch[35] Batch [3150]	Speed: 284.48 samples/sec 16231.30 tokens/sec 3.42 updates/sec	perplexity=12.542253	accuracy=0.426152
[2019-05-20:15:51:16:INFO:sockeye.training:__call__] Epoch[35] Batch [3200]	Speed: 416.62 samples/sec 17408.48 tokens/sec 3.58 updates/sec	perplexity=12.337507	accuracy=0.429677
[2019-05-20:15:51:30:INFO:sockeye.training:__call__] Epoch[36] Batch [3250]	Speed: 304.77 samples/sec 16660.74 tokens/sec 3.53 updates/sec	perplexity=12.135818	accuracy=0.433203
[2019-05-20:15:51:45:INFO:sockeye.training:__call__] Epoch[37] Batch [3300]	Speed: 370.45 samples/sec 15946.67 tokens/sec 3.28 updates/sec	perplexity=11.953684	accuracy=0.436390
[2019-05-20:15:52:01:INFO:sockeye.training:__call__] Epoch[37] Batch [3350]	Speed: 319.06 samples/sec 15342.36 tokens/sec 3.23 updates/sec	perplexity=11.779772	accuracy=0.439435
[2019-05-20:15:52:16:INFO:sockeye.training:__call__] Epoch[38] Batch [3400]	Speed: 316.49 samples/sec 15933.92 tokens/sec 3.28 updates/sec	perplexity=11.601907	accuracy=0.442684
[2019-05-20:15:52:30:INFO:sockeye.training:__call__] Epoch[38] Batch [3450]	Speed: 322.99 samples/sec 16330.85 tokens/sec 3.43 updates/sec	perplexity=11.430991	accuracy=0.445856
[2019-05-20:15:52:45:INFO:sockeye.training:__call__] Epoch[39] Batch [3500]	Speed: 484.30 samples/sec 16832.46 tokens/sec 3.40 updates/sec	perplexity=11.269967	accuracy=0.448878
[2019-05-20:15:53:00:INFO:sockeye.training:__call__] Epoch[39] Batch [3550]	Speed: 329.51 samples/sec 15859.47 tokens/sec 3.33 updates/sec	perplexity=11.105347	accuracy=0.452032
[2019-05-20:15:53:15:INFO:sockeye.training:__call__] Epoch[40] Batch [3600]	Speed: 360.64 samples/sec 16634.24 tokens/sec 3.47 updates/sec	perplexity=10.947452	accuracy=0.455081
[2019-05-20:15:53:29:INFO:sockeye.training:__call__] Epoch[41] Batch [3650]	Speed: 326.70 samples/sec 16505.52 tokens/sec 3.45 updates/sec	perplexity=10.810469	accuracy=0.457701
[2019-05-20:15:53:44:INFO:sockeye.training:__call__] Epoch[41] Batch [3700]	Speed: 305.02 samples/sec 15968.49 tokens/sec 3.36 updates/sec	perplexity=10.672916	accuracy=0.460432
[2019-05-20:15:53:59:INFO:sockeye.training:__call__] Epoch[42] Batch [3750]	Speed: 377.90 samples/sec 16234.33 tokens/sec 3.35 updates/sec	perplexity=10.535846	accuracy=0.463164
[2019-05-20:15:54:15:INFO:sockeye.training:__call__] Epoch[42] Batch [3800]	Speed: 240.90 samples/sec 14666.46 tokens/sec 3.11 updates/sec	perplexity=10.396919	accuracy=0.466010
[2019-05-20:15:54:29:INFO:sockeye.training:__call__] Epoch[43] Batch [3850]	Speed: 473.47 samples/sec 17475.28 tokens/sec 3.58 updates/sec	perplexity=10.271019	accuracy=0.468579
[2019-05-20:15:54:44:INFO:sockeye.training:__call__] Epoch[43] Batch [3900]	Speed: 363.81 samples/sec 16239.96 tokens/sec 3.36 updates/sec	perplexity=10.138691	accuracy=0.471348
[2019-05-20:15:54:58:INFO:sockeye.training:__call__] Epoch[44] Batch [3950]	Speed: 310.54 samples/sec 16408.72 tokens/sec 3.46 updates/sec	perplexity=10.026345	accuracy=0.473647
[2019-05-20:15:55:13:INFO:sockeye.training:__call__] Epoch[44] Batch [4000]	Speed: 384.20 samples/sec 16090.08 tokens/sec 3.30 updates/sec	perplexity=9.908104	accuracy=0.476117
[2019-05-20:15:55:13:INFO:root:save_params_to_file] Saved params to "/notebooks/sockeye/new_model/params.00001"
[2019-05-20:15:55:13:INFO:sockeye.training:fit] Checkpoint [1]	Updates=4000 Epoch=44 Samples=414732 Time-cost=1177.640 Updates/sec=3.397
[2019-05-20:15:55:13:INFO:sockeye.training:fit] Checkpoint [1]	Train-perplexity=9.908104
[2019-05-20:15:55:13:INFO:sockeye.training:fit] Checkpoint [1]	Train-accuracy=0.476117
[2019-05-20:15:55:16:INFO:sockeye.training:fit] Checkpoint [1]	Validation-perplexity=7.713157
[2019-05-20:15:55:16:INFO:sockeye.training:fit] Checkpoint [1]	Validation-accuracy=0.522051
[2019-05-20:15:55:16:INFO:sockeye.training:start_decoder] Starting process: Decoder-1
[2019-05-20:15:55:19:INFO:sockeye.training:fit] Validation-perplexity improved to 7.713157 (delta=inf).
[2019-05-20:15:55:22:INFO:sockeye.utils:log_gpu_memory_usage] GPU 0: 4228/24449 MB (17.29%)
[2019-05-20:15:55:45:INFO:sockeye.training:__call__] Epoch[45] Batch [4050]	Speed: 166.14 samples/sec 7742.43 tokens/sec 1.60 updates/sec	perplexity=3.723655	accuracy=0.683444
[2019-05-20:15:56:06:INFO:sockeye.training:__call__] Epoch[46] Batch [4100]	Speed: 228.17 samples/sec 11255.28 tokens/sec 2.37 updates/sec	perplexity=3.681616	accuracy=0.687389
[2019-05-20:15:56:23:INFO:sockeye.training:__call__] Epoch[46] Batch [4150]	Speed: 264.14 samples/sec 13638.60 tokens/sec 2.87 updates/sec	perplexity=3.724237	accuracy=0.684337
[2019-05-20:15:56:39:INFO:sockeye.training:__call__] Epoch[47] Batch [4200]	Speed: 357.94 samples/sec 15385.45 tokens/sec 3.17 updates/sec	perplexity=3.735399	accuracy=0.683758
[2019-05-20:15:56:54:INFO:sockeye.training:__call__] Epoch[47] Batch [4250]	Speed: 354.82 samples/sec 15648.08 tokens/sec 3.25 updates/sec	perplexity=3.694209	accuracy=0.686731
[2019-05-20:15:57:10:INFO:sockeye.training:__call__] Epoch[48] Batch [4300]	Speed: 412.37 samples/sec 15883.09 tokens/sec 3.24 updates/sec	perplexity=3.685713	accuracy=0.687178
[2019-05-20:15:57:24:INFO:sockeye.training:__call__] Epoch[48] Batch [4350]	Speed: 298.25 samples/sec 16110.21 tokens/sec 3.40 updates/sec	perplexity=3.698657	accuracy=0.686129
[2019-05-20:15:57:39:INFO:sockeye.training:__call__] Epoch[49] Batch [4400]	Speed: 269.76 samples/sec 16629.20 tokens/sec 3.51 updates/sec	perplexity=3.711617	accuracy=0.685162
[2019-05-20:15:57:52:INFO:sockeye.training:__call__] Epoch[50] Batch [4450]	Speed: 455.87 samples/sec 17659.73 tokens/sec 3.64 updates/sec	perplexity=3.665703	accuracy=0.688204
[2019-05-20:15:58:06:INFO:sockeye.training:__call__] Epoch[50] Batch [4500]	Speed: 397.58 samples/sec 17678.53 tokens/sec 3.67 updates/sec	perplexity=3.671571	accuracy=0.687681
[2019-05-20:15:58:20:INFO:sockeye.training:__call__] Epoch[51] Batch [4550]	Speed: 423.27 samples/sec 17500.81 tokens/sec 3.61 updates/sec	perplexity=3.628130	accuracy=0.690675
[2019-05-20:15:58:33:INFO:sockeye.training:__call__] Epoch[51] Batch [4600]	Speed: 356.53 samples/sec 17771.43 tokens/sec 3.73 updates/sec	perplexity=3.619148	accuracy=0.691272
[2019-05-20:15:58:47:INFO:sockeye.training:__call__] Epoch[52] Batch [4650]	Speed: 304.70 samples/sec 16967.14 tokens/sec 3.56 updates/sec	perplexity=3.584809	accuracy=0.693696
[2019-05-20:15:59:01:INFO:sockeye.training:__call__] Epoch[52] Batch [4700]	Speed: 422.62 samples/sec 17498.22 tokens/sec 3.64 updates/sec	perplexity=3.576935	accuracy=0.694116
[2019-05-20:15:59:15:INFO:sockeye.training:__call__] Epoch[53] Batch [4750]	Speed: 359.42 samples/sec 17712.40 tokens/sec 3.67 updates/sec	perplexity=3.553255	accuracy=0.695826
[2019-05-20:15:59:28:INFO:sockeye.training:__call__] Epoch[53] Batch [4800]	Speed: 401.86 samples/sec 17626.14 tokens/sec 3.65 updates/sec	perplexity=3.539572	accuracy=0.696769
[2019-05-20:15:59:42:INFO:sockeye.training:__call__] Epoch[54] Batch [4850]	Speed: 268.31 samples/sec 16676.98 tokens/sec 3.55 updates/sec	perplexity=3.530822	accuracy=0.697312
[2019-05-20:15:59:56:INFO:sockeye.training:__call__] Epoch[55] Batch [4900]	Speed: 493.63 samples/sec 18091.42 tokens/sec 3.68 updates/sec	perplexity=3.517584	accuracy=0.698169
[2019-05-20:16:00:10:INFO:sockeye.training:__call__] Epoch[55] Batch [4950]	Speed: 314.15 samples/sec 16697.87 tokens/sec 3.54 updates/sec	perplexity=3.501243	accuracy=0.699239
[2019-05-20:16:00:23:INFO:sockeye.training:__call__] Epoch[56] Batch [5000]	Speed: 436.03 samples/sec 18567.15 tokens/sec 3.81 updates/sec	perplexity=3.491679	accuracy=0.699847
[2019-05-20:16:00:37:INFO:sockeye.training:__call__] Epoch[56] Batch [5050]	Speed: 326.59 samples/sec 17020.26 tokens/sec 3.57 updates/sec	perplexity=3.469076	accuracy=0.701495
[2019-05-20:16:00:51:INFO:sockeye.training:__call__] Epoch[57] Batch [5100]	Speed: 431.51 samples/sec 17791.90 tokens/sec 3.68 updates/sec	perplexity=3.446054	accuracy=0.703108
[2019-05-20:16:01:04:INFO:sockeye.training:__call__] Epoch[57] Batch [5150]	Speed: 377.15 samples/sec 17838.30 tokens/sec 3.71 updates/sec	perplexity=3.435592	accuracy=0.703868
[2019-05-20:16:01:18:INFO:sockeye.training:__call__] Epoch[58] Batch [5200]	Speed: 329.21 samples/sec 17151.74 tokens/sec 3.60 updates/sec	perplexity=3.421517	accuracy=0.704848
[2019-05-20:16:01:32:INFO:sockeye.training:__call__] Epoch[58] Batch [5250]	Speed: 376.91 samples/sec 17749.85 tokens/sec 3.68 updates/sec	perplexity=3.406522	accuracy=0.705960
[2019-05-20:16:01:46:INFO:sockeye.training:__call__] Epoch[59] Batch [5300]	Speed: 411.70 samples/sec 17264.74 tokens/sec 3.57 updates/sec	perplexity=3.390485	accuracy=0.707100
[2019-05-20:16:01:59:INFO:sockeye.training:__call__] Epoch[60] Batch [5350]	Speed: 395.18 samples/sec 17798.13 tokens/sec 3.70 updates/sec	perplexity=3.371765	accuracy=0.708489
[2019-05-20:16:02:13:INFO:sockeye.training:__call__] Epoch[60] Batch [5400]	Speed: 346.32 samples/sec 17467.57 tokens/sec 3.66 updates/sec	perplexity=3.353803	accuracy=0.709826
[2019-05-20:16:02:27:INFO:sockeye.training:__call__] Epoch[61] Batch [5450]	Speed: 359.03 samples/sec 16997.80 tokens/sec 3.52 updates/sec	perplexity=3.333865	accuracy=0.711294
[2019-05-20:16:02:41:INFO:sockeye.training:__call__] Epoch[61] Batch [5500]	Speed: 418.35 samples/sec 17590.17 tokens/sec 3.64 updates/sec	perplexity=3.322953	accuracy=0.712046
[2019-05-20:16:02:54:INFO:sockeye.training:__call__] Epoch[62] Batch [5550]	Speed: 377.14 samples/sec 18243.21 tokens/sec 3.82 updates/sec	perplexity=3.300737	accuracy=0.713767
[2019-05-20:16:03:08:INFO:sockeye.training:__call__] Epoch[62] Batch [5600]	Speed: 395.17 samples/sec 17385.07 tokens/sec 3.59 updates/sec	perplexity=3.283932	accuracy=0.715093
[2019-05-20:16:03:22:INFO:sockeye.training:__call__] Epoch[63] Batch [5650]	Speed: 318.92 samples/sec 16514.37 tokens/sec 3.45 updates/sec	perplexity=3.265589	accuracy=0.716535
[2019-05-20:16:03:35:INFO:sockeye.training:__call__] Epoch[64] Batch [5700]	Speed: 412.76 samples/sec 18451.73 tokens/sec 3.85 updates/sec	perplexity=3.311039	accuracy=0.713592
[2019-05-20:16:03:49:INFO:sockeye.training:__call__] Epoch[64] Batch [5750]	Speed: 334.83 samples/sec 17353.68 tokens/sec 3.65 updates/sec	perplexity=3.303041	accuracy=0.714199
[2019-05-20:16:04:03:INFO:sockeye.training:__call__] Epoch[65] Batch [5800]	Speed: 417.40 samples/sec 17351.32 tokens/sec 3.58 updates/sec	perplexity=3.287576	accuracy=0.715361
[2019-05-20:16:04:17:INFO:sockeye.training:__call__] Epoch[65] Batch [5850]	Speed: 385.39 samples/sec 17625.33 tokens/sec 3.64 updates/sec	perplexity=3.275730	accuracy=0.716240
[2019-05-20:16:04:31:INFO:sockeye.training:__call__] Epoch[66] Batch [5900]	Speed: 370.70 samples/sec 16832.67 tokens/sec 3.53 updates/sec	perplexity=3.252956	accuracy=0.718032
[2019-05-20:16:04:44:INFO:sockeye.training:__call__] Epoch[66] Batch [5950]	Speed: 425.21 samples/sec 18412.94 tokens/sec 3.79 updates/sec	perplexity=3.233712	accuracy=0.719604
[2019-05-20:16:04:58:INFO:sockeye.training:__call__] Epoch[67] Batch [6000]	Speed: 290.37 samples/sec 16839.29 tokens/sec 3.57 updates/sec	perplexity=3.217570	accuracy=0.720886
[2019-05-20:16:05:12:INFO:sockeye.training:__call__] Epoch[67] Batch [6050]	Speed: 426.09 samples/sec 17849.94 tokens/sec 3.67 updates/sec	perplexity=3.198084	accuracy=0.722444
[2019-05-20:16:05:25:INFO:sockeye.training:__call__] Epoch[68] Batch [6100]	Speed: 399.07 samples/sec 18033.98 tokens/sec 3.77 updates/sec	perplexity=3.182863	accuracy=0.723633
[2019-05-20:16:05:40:INFO:sockeye.training:__call__] Epoch[69] Batch [6150]	Speed: 315.40 samples/sec 16472.99 tokens/sec 3.45 updates/sec	perplexity=3.165129	accuracy=0.725067
[2019-05-20:16:05:53:INFO:sockeye.training:__call__] Epoch[69] Batch [6200]	Speed: 444.19 samples/sec 18042.18 tokens/sec 3.69 updates/sec	perplexity=3.146614	accuracy=0.726623
[2019-05-20:16:06:07:INFO:sockeye.training:__call__] Epoch[70] Batch [6250]	Speed: 319.81 samples/sec 17249.61 tokens/sec 3.65 updates/sec	perplexity=3.125897	accuracy=0.728331
[2019-05-20:16:06:21:INFO:sockeye.training:__call__] Epoch[70] Batch [6300]	Speed: 401.38 samples/sec 17471.09 tokens/sec 3.63 updates/sec	perplexity=3.107287	accuracy=0.729885
[2019-05-20:16:06:34:INFO:sockeye.training:__call__] Epoch[71] Batch [6350]	Speed: 368.20 samples/sec 17475.64 tokens/sec 3.63 updates/sec	perplexity=3.089010	accuracy=0.731412
[2019-05-20:16:06:48:INFO:sockeye.training:__call__] Epoch[71] Batch [6400]	Speed: 405.44 samples/sec 17418.87 tokens/sec 3.62 updates/sec	perplexity=3.068182	accuracy=0.733185
[2019-05-20:16:07:02:INFO:sockeye.training:__call__] Epoch[72] Batch [6450]	Speed: 384.17 samples/sec 17483.17 tokens/sec 3.60 updates/sec	perplexity=3.048945	accuracy=0.734808
[2019-05-20:16:07:16:INFO:sockeye.training:__call__] Epoch[73] Batch [6500]	Speed: 335.99 samples/sec 17346.57 tokens/sec 3.65 updates/sec	perplexity=3.028548	accuracy=0.736575
[2019-05-20:16:07:30:INFO:sockeye.training:__call__] Epoch[73] Batch [6550]	Speed: 346.36 samples/sec 17036.43 tokens/sec 3.55 updates/sec	perplexity=3.007008	accuracy=0.738439
[2019-05-20:16:07:44:INFO:sockeye.training:__call__] Epoch[74] Batch [6600]	Speed: 408.10 samples/sec 17484.69 tokens/sec 3.63 updates/sec	perplexity=2.988523	accuracy=0.740060
[2019-05-20:16:07:57:INFO:sockeye.training:__call__] Epoch[74] Batch [6650]	Speed: 406.98 samples/sec 18002.84 tokens/sec 3.71 updates/sec	perplexity=2.967217	accuracy=0.741937
[2019-05-20:16:08:11:INFO:sockeye.training:__call__] Epoch[75] Batch [6700]	Speed: 432.41 samples/sec 17870.72 tokens/sec 3.70 updates/sec	perplexity=2.947546	accuracy=0.743718
[2019-05-20:16:08:24:INFO:sockeye.training:__call__] Epoch[75] Batch [6750]	Speed: 338.53 samples/sec 17210.16 tokens/sec 3.63 updates/sec	perplexity=2.928897	accuracy=0.745395
[2019-05-20:16:08:38:INFO:sockeye.training:__call__] Epoch[76] Batch [6800]	Speed: 374.68 samples/sec 17671.65 tokens/sec 3.64 updates/sec	perplexity=2.908072	accuracy=0.747296
[2019-05-20:16:08:52:INFO:sockeye.training:__call__] Epoch[76] Batch [6850]	Speed: 351.95 samples/sec 17104.63 tokens/sec 3.59 updates/sec	perplexity=2.887127	accuracy=0.749213
[2019-05-20:16:09:05:INFO:sockeye.training:__call__] Epoch[77] Batch [6900]	Speed: 365.49 samples/sec 18034.34 tokens/sec 3.75 updates/sec	perplexity=2.866674	accuracy=0.751123
[2019-05-20:16:09:20:INFO:sockeye.training:__call__] Epoch[78] Batch [6950]	Speed: 349.90 samples/sec 16616.45 tokens/sec 3.45 updates/sec	perplexity=2.846947	accuracy=0.752964
[2019-05-20:16:09:34:INFO:sockeye.training:__call__] Epoch[78] Batch [7000]	Speed: 316.51 samples/sec 17138.35 tokens/sec 3.63 updates/sec	perplexity=2.826750	accuracy=0.754862
[2019-05-20:16:09:48:INFO:sockeye.training:__call__] Epoch[79] Batch [7050]	Speed: 392.97 samples/sec 17203.42 tokens/sec 3.58 updates/sec	perplexity=2.804492	accuracy=0.756992
[2019-05-20:16:10:01:INFO:sockeye.training:__call__] Epoch[79] Batch [7100]	Speed: 464.43 samples/sec 17961.64 tokens/sec 3.70 updates/sec	perplexity=2.789710	accuracy=0.758493
[2019-05-20:16:10:15:INFO:sockeye.training:__call__] Epoch[80] Batch [7150]	Speed: 371.75 samples/sec 17540.10 tokens/sec 3.61 updates/sec	perplexity=2.772271	accuracy=0.760192
[2019-05-20:16:10:28:INFO:sockeye.training:__call__] Epoch[80] Batch [7200]	Speed: 353.21 samples/sec 17804.12 tokens/sec 3.74 updates/sec	perplexity=2.751008	accuracy=0.762270
[2019-05-20:16:10:42:INFO:sockeye.training:__call__] Epoch[81] Batch [7250]	Speed: 355.16 samples/sec 17149.99 tokens/sec 3.57 updates/sec	perplexity=2.729344	accuracy=0.764418
[2019-05-20:16:10:56:INFO:sockeye.training:__call__] Epoch[82] Batch [7300]	Speed: 420.34 samples/sec 18065.66 tokens/sec 3.76 updates/sec	perplexity=2.707954	accuracy=0.766570
[2019-05-20:16:11:09:INFO:sockeye.training:__call__] Epoch[82] Batch [7350]	Speed: 461.66 samples/sec 18010.75 tokens/sec 3.68 updates/sec	perplexity=2.685071	accuracy=0.768889
[2019-05-20:16:11:23:INFO:sockeye.training:__call__] Epoch[83] Batch [7400]	Speed: 293.96 samples/sec 17062.39 tokens/sec 3.61 updates/sec	perplexity=2.664516	accuracy=0.770969
[2019-05-20:16:11:37:INFO:sockeye.training:__call__] Epoch[83] Batch [7450]	Speed: 385.84 samples/sec 17202.21 tokens/sec 3.56 updates/sec	perplexity=2.643929	accuracy=0.773086
[2019-05-20:16:11:51:INFO:sockeye.training:__call__] Epoch[84] Batch [7500]	Speed: 343.38 samples/sec 17757.75 tokens/sec 3.71 updates/sec	perplexity=2.623312	accuracy=0.775238
[2019-05-20:16:12:05:INFO:sockeye.training:__call__] Epoch[84] Batch [7550]	Speed: 434.25 samples/sec 17397.22 tokens/sec 3.61 updates/sec	perplexity=2.602923	accuracy=0.777376
[2019-05-20:16:12:18:INFO:sockeye.training:__call__] Epoch[85] Batch [7600]	Speed: 278.37 samples/sec 17256.70 tokens/sec 3.67 updates/sec	perplexity=2.582350	accuracy=0.779531
[2019-05-20:16:12:32:INFO:sockeye.training:__call__] Epoch[85] Batch [7650]	Speed: 435.94 samples/sec 17461.61 tokens/sec 3.58 updates/sec	perplexity=2.562063	accuracy=0.781700
[2019-05-20:16:12:46:INFO:sockeye.training:__call__] Epoch[86] Batch [7700]	Speed: 404.19 samples/sec 17869.78 tokens/sec 3.68 updates/sec	perplexity=2.541628	accuracy=0.783883
[2019-05-20:16:13:00:INFO:sockeye.training:__call__] Epoch[87] Batch [7750]	Speed: 358.22 samples/sec 17300.32 tokens/sec 3.60 updates/sec	perplexity=2.534727	accuracy=0.784913
[2019-05-20:16:13:13:INFO:sockeye.training:__call__] Epoch[87] Batch [7800]	Speed: 434.57 samples/sec 17854.40 tokens/sec 3.69 updates/sec	perplexity=2.521827	accuracy=0.786366
[2019-05-20:16:13:27:INFO:sockeye.training:__call__] Epoch[88] Batch [7850]	Speed: 314.17 samples/sec 17305.52 tokens/sec 3.67 updates/sec	perplexity=2.504872	accuracy=0.788209
[2019-05-20:16:13:41:INFO:sockeye.training:__call__] Epoch[88] Batch [7900]	Speed: 379.83 samples/sec 16869.19 tokens/sec 3.49 updates/sec	perplexity=2.487102	accuracy=0.790171
[2019-05-20:16:13:55:INFO:sockeye.training:__call__] Epoch[89] Batch [7950]	Speed: 407.62 samples/sec 17570.94 tokens/sec 3.62 updates/sec	perplexity=2.470340	accuracy=0.792040
[2019-05-20:16:14:09:INFO:sockeye.training:__call__] Epoch[89] Batch [8000]	Speed: 345.42 samples/sec 17306.77 tokens/sec 3.65 updates/sec	perplexity=2.452582	accuracy=0.794001
[2019-05-20:16:14:09:INFO:root:save_params_to_file] Saved params to "/notebooks/sockeye/new_model/params.00002"
[2019-05-20:16:14:09:INFO:sockeye.training:fit] Checkpoint [2]	Updates=8000 Epoch=89 Samples=829424 Time-cost=1125.267 Updates/sec=3.555
[2019-05-20:16:14:09:INFO:sockeye.training:fit] Checkpoint [2]	Train-perplexity=2.452582
[2019-05-20:16:14:09:INFO:sockeye.training:fit] Checkpoint [2]	Train-accuracy=0.794001
[2019-05-20:16:14:11:INFO:sockeye.training:fit] Checkpoint [2]	Validation-perplexity=1.753480
[2019-05-20:16:14:11:INFO:sockeye.training:fit] Checkpoint [2]	Validation-accuracy=0.892073
[2019-05-20:16:14:11:INFO:sockeye.training:start_decoder] Starting process: Decoder-2
[2019-05-20:16:14:13:INFO:sockeye.training:fit] Validation-perplexity improved to 1.753480 (delta=5.959677).
[2019-05-20:16:14:16:INFO:sockeye.utils:log_gpu_memory_usage] GPU 0: 4302/24449 MB (17.60%)
[2019-05-20:16:14:38:INFO:sockeye.training:__call__] Epoch[90] Batch [8050]	Speed: 142.07 samples/sec 8141.53 tokens/sec 1.72 updates/sec	perplexity=1.369613	accuracy=0.951927
[2019-05-20:16:14:56:INFO:sockeye.training:__call__] Epoch[91] Batch [8100]	Speed: 335.42 samples/sec 13301.86 tokens/sec 2.74 updates/sec	perplexity=1.356568	accuracy=0.954869
[2019-05-20:16:15:13:INFO:sockeye.training:__call__] Epoch[91] Batch [8150]	Speed: 255.60 samples/sec 14287.60 tokens/sec 3.03 updates/sec	perplexity=1.347562	accuracy=0.956561
[2019-05-20:16:15:26:INFO:sockeye.training:__call__] Epoch[92] Batch [8200]	Speed: 434.12 samples/sec 17994.10 tokens/sec 3.70 updates/sec	perplexity=1.341002	accuracy=0.957886
[2019-05-20:16:15:39:INFO:sockeye.training:__call__] Epoch[92] Batch [8250]	Speed: 412.28 samples/sec 18087.63 tokens/sec 3.75 updates/sec	perplexity=1.334589	accuracy=0.959056
[2019-05-20:16:15:54:INFO:sockeye.training:__call__] Epoch[93] Batch [8300]	Speed: 386.74 samples/sec 16683.14 tokens/sec 3.45 updates/sec	perplexity=1.331598	accuracy=0.959696
[2019-05-20:16:16:08:INFO:sockeye.training:__call__] Epoch[93] Batch [8350]	Speed: 338.70 samples/sec 17400.83 tokens/sec 3.62 updates/sec	perplexity=1.329850	accuracy=0.960057
[2019-05-20:16:16:21:INFO:sockeye.training:__call__] Epoch[94] Batch [8400]	Speed: 401.81 samples/sec 18037.61 tokens/sec 3.77 updates/sec	perplexity=1.324688	accuracy=0.961007
[2019-05-20:16:16:35:INFO:sockeye.training:__call__] Epoch[94] Batch [8450]	Speed: 363.85 samples/sec 17025.67 tokens/sec 3.54 updates/sec	perplexity=1.323271	accuracy=0.961344
[2019-05-20:16:16:49:INFO:sockeye.training:__call__] Epoch[95] Batch [8500]	Speed: 409.58 samples/sec 17914.28 tokens/sec 3.71 updates/sec	perplexity=1.322961	accuracy=0.961511
[2019-05-20:16:17:02:INFO:sockeye.training:__call__] Epoch[96] Batch [8550]	Speed: 382.64 samples/sec 17331.47 tokens/sec 3.61 updates/sec	perplexity=1.319644	accuracy=0.962132
[2019-05-20:16:17:16:INFO:sockeye.training:__call__] Epoch[96] Batch [8600]	Speed: 367.52 samples/sec 17359.57 tokens/sec 3.63 updates/sec	perplexity=1.316905	accuracy=0.962654
[2019-05-20:16:17:31:INFO:sockeye.training:__call__] Epoch[97] Batch [8650]	Speed: 361.73 samples/sec 16735.70 tokens/sec 3.48 updates/sec	perplexity=1.313149	accuracy=0.963326
[2019-05-20:16:17:44:INFO:sockeye.training:__call__] Epoch[97] Batch [8700]	Speed: 372.82 samples/sec 17620.16 tokens/sec 3.70 updates/sec	perplexity=1.309581	accuracy=0.963977
[2019-05-20:16:17:58:INFO:sockeye.training:__call__] Epoch[98] Batch [8750]	Speed: 383.69 samples/sec 17485.20 tokens/sec 3.61 updates/sec	perplexity=1.311820	accuracy=0.963744
[2019-05-20:16:18:12:INFO:sockeye.training:__call__] Epoch[98] Batch [8800]	Speed: 383.70 samples/sec 17634.81 tokens/sec 3.68 updates/sec	perplexity=1.315067	accuracy=0.963233
[2019-05-20:16:18:26:INFO:sockeye.training:__call__] Epoch[99] Batch [8850]	Speed: 344.02 samples/sec 17111.15 tokens/sec 3.54 updates/sec	perplexity=1.330118	accuracy=0.960890
[2019-05-20:16:18:39:INFO:sockeye.training:__call__] Epoch[100] Batch [8900]	Speed: 372.70 samples/sec 17596.88 tokens/sec 3.69 updates/sec	perplexity=1.330485	accuracy=0.960728
[2019-05-20:16:18:53:INFO:sockeye.training:__call__] Epoch[100] Batch [8950]	Speed: 367.53 samples/sec 17157.79 tokens/sec 3.58 updates/sec	perplexity=1.327898	accuracy=0.961191
[2019-05-20:16:19:06:INFO:sockeye.training:__call__] Epoch[101] Batch [9000]	Speed: 385.36 samples/sec 18214.48 tokens/sec 3.79 updates/sec	perplexity=1.325126	accuracy=0.961663
[2019-05-20:16:19:20:INFO:sockeye.training:__call__] Epoch[101] Batch [9050]	Speed: 340.04 samples/sec 16989.48 tokens/sec 3.54 updates/sec	perplexity=1.321789	accuracy=0.962249
[2019-05-20:16:19:34:INFO:sockeye.training:__call__] Epoch[102] Batch [9100]	Speed: 398.53 samples/sec 17498.06 tokens/sec 3.66 updates/sec	perplexity=1.318145	accuracy=0.962884
[2019-05-20:16:19:48:INFO:sockeye.training:__call__] Epoch[102] Batch [9150]	Speed: 353.99 samples/sec 17306.25 tokens/sec 3.63 updates/sec	perplexity=1.314829	accuracy=0.963464
[2019-05-20:16:20:01:INFO:sockeye.training:__call__] Epoch[103] Batch [9200]	Speed: 426.65 samples/sec 18386.20 tokens/sec 3.78 updates/sec	perplexity=1.311282	accuracy=0.964074
[2019-05-20:16:20:15:INFO:sockeye.training:__call__] Epoch[103] Batch [9250]	Speed: 385.07 samples/sec 17205.03 tokens/sec 3.56 updates/sec	perplexity=1.308708	accuracy=0.964524
[2019-05-20:16:20:29:INFO:sockeye.training:__call__] Epoch[104] Batch [9300]	Speed: 388.77 samples/sec 17981.54 tokens/sec 3.76 updates/sec	perplexity=1.320381	accuracy=0.963104
[2019-05-20:16:20:42:INFO:sockeye.training:__call__] Epoch[105] Batch [9350]	Speed: 394.10 samples/sec 17345.49 tokens/sec 3.59 updates/sec	perplexity=1.326359	accuracy=0.962022
[2019-05-20:16:20:56:INFO:sockeye.training:__call__] Epoch[105] Batch [9400]	Speed: 400.57 samples/sec 17537.17 tokens/sec 3.65 updates/sec	perplexity=1.327262	accuracy=0.961879
[2019-05-20:16:21:10:INFO:sockeye.training:__call__] Epoch[106] Batch [9450]	Speed: 322.49 samples/sec 17388.96 tokens/sec 3.64 updates/sec	perplexity=1.335112	accuracy=0.960746
[2019-05-20:16:21:23:INFO:sockeye.training:__call__] Epoch[106] Batch [9500]	Speed: 326.87 samples/sec 17547.50 tokens/sec 3.68 updates/sec	perplexity=1.337783	accuracy=0.960260
[2019-05-20:16:21:37:INFO:sockeye.training:__call__] Epoch[107] Batch [9550]	Speed: 422.48 samples/sec 17535.70 tokens/sec 3.63 updates/sec	perplexity=1.336347	accuracy=0.960485
[2019-05-20:16:21:51:INFO:sockeye.training:__call__] Epoch[107] Batch [9600]	Speed: 398.94 samples/sec 17494.09 tokens/sec 3.62 updates/sec	perplexity=1.334590	accuracy=0.960791
[2019-05-20:16:22:05:INFO:sockeye.training:__call__] Epoch[108] Batch [9650]	Speed: 390.00 samples/sec 17687.33 tokens/sec 3.69 updates/sec	perplexity=1.332153	accuracy=0.961188
[2019-05-20:16:22:18:INFO:sockeye.training:__call__] Epoch[108] Batch [9700]	Speed: 362.47 samples/sec 17544.19 tokens/sec 3.68 updates/sec	perplexity=1.329995	accuracy=0.961521
[2019-05-20:16:22:32:INFO:sockeye.training:__call__] Epoch[109] Batch [9750]	Speed: 299.25 samples/sec 16900.05 tokens/sec 3.52 updates/sec	perplexity=1.327893	accuracy=0.961856
[2019-05-20:16:22:46:INFO:sockeye.training:__call__] Epoch[110] Batch [9800]	Speed: 441.37 samples/sec 18359.88 tokens/sec 3.81 updates/sec	perplexity=1.325122	accuracy=0.962297
[2019-05-20:16:23:00:INFO:sockeye.training:__call__] Epoch[110] Batch [9850]	Speed: 383.21 samples/sec 17144.88 tokens/sec 3.55 updates/sec	perplexity=1.322535	accuracy=0.962707
[2019-05-20:16:23:13:INFO:sockeye.training:__call__] Epoch[111] Batch [9900]	Speed: 356.32 samples/sec 17616.23 tokens/sec 3.70 updates/sec	perplexity=1.319876	accuracy=0.963143
[2019-05-20:16:23:27:INFO:sockeye.training:__call__] Epoch[111] Batch [9950]	Speed: 371.04 samples/sec 17430.87 tokens/sec 3.61 updates/sec	perplexity=1.317571	accuracy=0.963519
[2019-05-20:16:23:41:INFO:sockeye.training:__call__] Epoch[112] Batch [10000]	Speed: 417.06 samples/sec 17299.88 tokens/sec 3.60 updates/sec	perplexity=1.315085	accuracy=0.963924
[2019-05-20:16:23:55:INFO:sockeye.training:__call__] Epoch[112] Batch [10050]	Speed: 376.45 samples/sec 17526.81 tokens/sec 3.62 updates/sec	perplexity=1.312918	accuracy=0.964281
[2019-05-20:16:24:08:INFO:sockeye.training:__call__] Epoch[113] Batch [10100]	Speed: 407.87 samples/sec 17642.28 tokens/sec 3.64 updates/sec	perplexity=1.310737	accuracy=0.964646
[2019-05-20:16:24:22:INFO:sockeye.training:__call__] Epoch[114] Batch [10150]	Speed: 314.04 samples/sec 16867.64 tokens/sec 3.56 updates/sec	perplexity=1.308775	accuracy=0.964963
[2019-05-20:16:24:36:INFO:sockeye.training:__call__] Epoch[114] Batch [10200]	Speed: 433.00 samples/sec 18140.64 tokens/sec 3.73 updates/sec	perplexity=1.311153	accuracy=0.964706
[2019-05-20:16:24:50:INFO:sockeye.training:__call__] Epoch[115] Batch [10250]	Speed: 326.99 samples/sec 17146.68 tokens/sec 3.62 updates/sec	perplexity=1.312669	accuracy=0.964450
[2019-05-20:16:25:04:INFO:sockeye.training:__call__] Epoch[115] Batch [10300]	Speed: 425.45 samples/sec 17236.14 tokens/sec 3.56 updates/sec	perplexity=1.311631	accuracy=0.964585
[2019-05-20:16:25:17:INFO:sockeye.training:__call__] Epoch[116] Batch [10350]	Speed: 364.52 samples/sec 17736.74 tokens/sec 3.68 updates/sec	perplexity=1.310270	accuracy=0.964811
[2019-05-20:16:25:31:INFO:sockeye.training:__call__] Epoch[116] Batch [10400]	Speed: 408.63 samples/sec 17686.28 tokens/sec 3.69 updates/sec	perplexity=1.308448	accuracy=0.965090
[2019-05-20:16:25:45:INFO:sockeye.training:__call__] Epoch[117] Batch [10450]	Speed: 359.15 samples/sec 16860.21 tokens/sec 3.48 updates/sec	perplexity=1.306923	accuracy=0.965337
[2019-05-20:16:25:59:INFO:sockeye.training:__call__] Epoch[117] Batch [10500]	Speed: 331.78 samples/sec 16969.34 tokens/sec 3.56 updates/sec	perplexity=1.305026	accuracy=0.965637
[2019-05-20:16:26:13:INFO:sockeye.training:__call__] Epoch[118] Batch [10550]	Speed: 339.65 samples/sec 17255.84 tokens/sec 3.62 updates/sec	perplexity=1.303103	accuracy=0.965944
[2019-05-20:16:26:27:INFO:sockeye.training:__call__] Epoch[119] Batch [10600]	Speed: 406.23 samples/sec 17143.45 tokens/sec 3.54 updates/sec	perplexity=1.301368	accuracy=0.966225
[2019-05-20:16:26:41:INFO:sockeye.training:__call__] Epoch[119] Batch [10650]	Speed: 315.33 samples/sec 17106.35 tokens/sec 3.59 updates/sec	perplexity=1.299599	accuracy=0.966503
[2019-05-20:16:26:55:INFO:sockeye.training:__call__] Epoch[120] Batch [10700]	Speed: 387.40 samples/sec 17533.47 tokens/sec 3.65 updates/sec	perplexity=1.297798	accuracy=0.966801
[2019-05-20:16:27:09:INFO:sockeye.training:__call__] Epoch[120] Batch [10750]	Speed: 421.07 samples/sec 17571.88 tokens/sec 3.63 updates/sec	perplexity=1.295916	accuracy=0.967105
[2019-05-20:16:27:23:INFO:sockeye.training:__call__] Epoch[121] Batch [10800]	Speed: 367.28 samples/sec 17316.59 tokens/sec 3.57 updates/sec	perplexity=1.294223	accuracy=0.967379
[2019-05-20:16:27:37:INFO:sockeye.training:__call__] Epoch[121] Batch [10850]	Speed: 368.39 samples/sec 16823.12 tokens/sec 3.52 updates/sec	perplexity=1.292495	accuracy=0.967657
[2019-05-20:16:27:50:INFO:sockeye.training:__call__] Epoch[122] Batch [10900]	Speed: 393.19 samples/sec 17957.79 tokens/sec 3.75 updates/sec	perplexity=1.290808	accuracy=0.967931
[2019-05-20:16:28:04:INFO:sockeye.training:__call__] Epoch[123] Batch [10950]	Speed: 347.62 samples/sec 17033.59 tokens/sec 3.55 updates/sec	perplexity=1.289082	accuracy=0.968218
[2019-05-20:16:28:18:INFO:sockeye.training:__call__] Epoch[123] Batch [11000]	Speed: 383.85 samples/sec 17675.90 tokens/sec 3.66 updates/sec	perplexity=1.287458	accuracy=0.968484
[2019-05-20:16:28:32:INFO:sockeye.training:__call__] Epoch[124] Batch [11050]	Speed: 340.05 samples/sec 16828.27 tokens/sec 3.54 updates/sec	perplexity=1.285755	accuracy=0.968758
[2019-05-20:16:28:46:INFO:sockeye.training:__call__] Epoch[124] Batch [11100]	Speed: 425.75 samples/sec 17155.02 tokens/sec 3.55 updates/sec	perplexity=1.284171	accuracy=0.969022
[2019-05-20:16:29:00:INFO:sockeye.training:__call__] Epoch[125] Batch [11150]	Speed: 345.48 samples/sec 17317.51 tokens/sec 3.61 updates/sec	perplexity=1.282648	accuracy=0.969267
[2019-05-20:16:29:14:INFO:sockeye.training:__call__] Epoch[125] Batch [11200]	Speed: 372.54 samples/sec 17325.78 tokens/sec 3.59 updates/sec	perplexity=1.281639	accuracy=0.969440
[2019-05-20:16:29:28:INFO:sockeye.training:__call__] Epoch[126] Batch [11250]	Speed: 364.69 samples/sec 17058.07 tokens/sec 3.53 updates/sec	perplexity=1.280335	accuracy=0.969650
[2019-05-20:16:29:42:INFO:sockeye.training:__call__] Epoch[126] Batch [11300]	Speed: 388.34 samples/sec 17424.17 tokens/sec 3.64 updates/sec	perplexity=1.278984	accuracy=0.969869
[2019-05-20:16:29:56:INFO:sockeye.training:__call__] Epoch[127] Batch [11350]	Speed: 429.75 samples/sec 17312.14 tokens/sec 3.59 updates/sec	perplexity=1.277456	accuracy=0.970124
[2019-05-20:16:30:10:INFO:sockeye.training:__call__] Epoch[128] Batch [11400]	Speed: 276.86 samples/sec 16858.29 tokens/sec 3.54 updates/sec	perplexity=1.276239	accuracy=0.970319
[2019-05-20:16:30:24:INFO:sockeye.training:__call__] Epoch[128] Batch [11450]	Speed: 389.05 samples/sec 17527.22 tokens/sec 3.65 updates/sec	perplexity=1.274855	accuracy=0.970542
[2019-05-20:16:30:38:INFO:sockeye.training:__call__] Epoch[129] Batch [11500]	Speed: 370.61 samples/sec 17129.17 tokens/sec 3.54 updates/sec	perplexity=1.273540	accuracy=0.970759
[2019-05-20:16:30:52:INFO:sockeye.training:__call__] Epoch[129] Batch [11550]	Speed: 317.85 samples/sec 16959.54 tokens/sec 3.58 updates/sec	perplexity=1.272179	accuracy=0.970988
[2019-05-20:16:31:05:INFO:sockeye.training:__call__] Epoch[130] Batch [11600]	Speed: 442.32 samples/sec 17771.47 tokens/sec 3.63 updates/sec	perplexity=1.270861	accuracy=0.971209
[2019-05-20:16:31:19:INFO:sockeye.training:__call__] Epoch[130] Batch [11650]	Speed: 326.61 samples/sec 16889.41 tokens/sec 3.57 updates/sec	perplexity=1.269596	accuracy=0.971413
[2019-05-20:16:31:33:INFO:sockeye.training:__call__] Epoch[131] Batch [11700]	Speed: 400.73 samples/sec 17400.43 tokens/sec 3.63 updates/sec	perplexity=1.268245	accuracy=0.971638
[2019-05-20:16:31:47:INFO:sockeye.training:__call__] Epoch[132] Batch [11750]	Speed: 407.92 samples/sec 17816.79 tokens/sec 3.66 updates/sec	perplexity=1.267021	accuracy=0.971839
[2019-05-20:16:32:01:INFO:sockeye.training:__call__] Epoch[132] Batch [11800]	Speed: 386.57 samples/sec 17430.97 tokens/sec 3.62 updates/sec	perplexity=1.265847	accuracy=0.972033
[2019-05-20:16:32:15:INFO:sockeye.training:__call__] Epoch[133] Batch [11850]	Speed: 350.18 samples/sec 16916.55 tokens/sec 3.54 updates/sec	perplexity=1.264566	accuracy=0.972242
[2019-05-20:16:32:28:INFO:sockeye.training:__call__] Epoch[133] Batch [11900]	Speed: 398.77 samples/sec 17570.14 tokens/sec 3.67 updates/sec	perplexity=1.263358	accuracy=0.972445
[2019-05-20:16:32:43:INFO:sockeye.training:__call__] Epoch[134] Batch [11950]	Speed: 358.43 samples/sec 17044.32 tokens/sec 3.50 updates/sec	perplexity=1.262220	accuracy=0.972636
[2019-05-20:16:32:56:INFO:sockeye.training:__call__] Epoch[134] Batch [12000]	Speed: 374.10 samples/sec 17349.21 tokens/sec 3.63 updates/sec	perplexity=1.261020	accuracy=0.972836
[2019-05-20:16:32:57:INFO:root:save_params_to_file] Saved params to "/notebooks/sockeye/new_model/params.00003"
[2019-05-20:16:32:57:INFO:sockeye.training:fit] Checkpoint [3]	Updates=12000 Epoch=134 Samples=1244166 Time-cost=1119.100 Updates/sec=3.574
[2019-05-20:16:32:57:INFO:sockeye.training:fit] Checkpoint [3]	Train-perplexity=1.261020
[2019-05-20:16:32:57:INFO:sockeye.training:fit] Checkpoint [3]	Train-accuracy=0.972836
[2019-05-20:16:32:59:INFO:sockeye.training:fit] Checkpoint [3]	Validation-perplexity=1.346223
[2019-05-20:16:32:59:INFO:sockeye.training:fit] Checkpoint [3]	Validation-accuracy=0.956674
[2019-05-20:16:32:59:INFO:sockeye.training:start_decoder] Starting process: Decoder-3
[2019-05-20:16:33:01:INFO:sockeye.training:fit] Validation-perplexity improved to 1.346223 (delta=0.407257).
[2019-05-20:16:33:03:INFO:sockeye.utils:log_gpu_memory_usage] GPU 0: 4282/24449 MB (17.51%)
[2019-05-20:16:33:24:INFO:sockeye.training:__call__] Epoch[135] Batch [12050]	Speed: 175.28 samples/sec 8539.64 tokens/sec 1.79 updates/sec	perplexity=1.171303	accuracy=0.988485
[2019-05-20:16:33:44:INFO:sockeye.training:__call__] Epoch[135] Batch [12100]	Speed: 273.28 samples/sec 12228.70 tokens/sec 2.53 updates/sec	perplexity=1.170912	accuracy=0.988429
[2019-05-20:16:34:00:INFO:sockeye.training:__call__] Epoch[136] Batch [12150]	Speed: 400.08 samples/sec 15045.59 tokens/sec 3.06 updates/sec	perplexity=1.170549	accuracy=0.988540
[2019-05-20:16:34:07:INFO:sockeye.utils:__exit__] Releasing GPU 0.
[2019-05-20:16:34:07:ERROR:root:exception_hook] Uncaught exception
Traceback (most recent call last):
  File "/usr/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/notebooks/sockeye/sockeye/train.py", line 966, in <module>
    main()
  File "/notebooks/sockeye/sockeye/train.py", line 832, in main
    train(args)
  File "/notebooks/sockeye/sockeye/train.py", line 962, in train
    existing_parameters=args.params)
  File "/notebooks/sockeye/sockeye/training.py", line 675, in fit
    self._step(self.model, batch, checkpoint_interval, metric_train, metric_loss)
  File "/notebooks/sockeye/sockeye/training.py", line 829, in _step
    model.run_forward_backward(batch, metric_train)
  File "/notebooks/sockeye/sockeye/training.py", line 279, in run_forward_backward
    self.module.update_metric(metric, batch.label)
  File "/usr/local/lib/python3.6/dist-packages/mxnet/module/bucketing_module.py", line 530, in update_metric
    self._curr_module.update_metric(eval_metric, labels, pre_sliced)
  File "/usr/local/lib/python3.6/dist-packages/mxnet/module/module.py", line 773, in update_metric
    self._exec_group.update_metric(eval_metric, labels, pre_sliced)
  File "/usr/local/lib/python3.6/dist-packages/mxnet/module/executor_group.py", line 639, in update_metric
    eval_metric.update_dict(labels_, preds)
  File "/usr/local/lib/python3.6/dist-packages/mxnet/metric.py", line 304, in update_dict
    metric.update_dict(labels, preds)
  File "/usr/local/lib/python3.6/dist-packages/mxnet/metric.py", line 132, in update_dict
    self.update(label, pred)
  File "/usr/local/lib/python3.6/dist-packages/mxnet/metric.py", line 869, in update
    num -= ndarray.sum(ignore).asscalar()
  File "/usr/local/lib/python3.6/dist-packages/mxnet/ndarray/ndarray.py", line 1998, in asscalar
    return self.asnumpy()[0]
  File "/usr/local/lib/python3.6/dist-packages/mxnet/ndarray/ndarray.py", line 1980, in asnumpy
    ctypes.c_size_t(data.size)))
KeyboardInterrupt
